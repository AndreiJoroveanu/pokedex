import{r as d,u as V,j as s,g as X,m as C,s as Y,H as Z,A as ee,a as k,b as A,c as te,d as re,L as se,e as R}from"./index-BnnnvK1R.js";import{a as E,u as O,b as T,B as w,c as ne}from"./useSpecificPokemon-cZ7jLk64.js";const oe=()=>{const e=d.useCallback(()=>E.getPokemonSpeciesList(),[]),{data:r,isLoading:t,error:c}=O(e);return{data:d.useMemo(()=>r==null?void 0:r.results.map(n=>({id:Number(n.url.split("https://pokeapi.co/api/v2/pokemon-species/")[1].split("/")[0]),name:n.name})),[r]),isLoading:t,error:c}},y=()=>{const[e,r]=V(),t=a=>e.get(a);return{getUrl:t,setUrl:(a,n)=>{t(a)===n||n===""?e.delete(a):e.set(a,n),a!=="page"&&e.get("page")&&e.delete("page");const l=new URLSearchParams;["page","generation","type","onlyStarred","q"].map(o=>{const i=e.get(o);i&&l.set(o,i)}),r(l)}}},ae=e=>{const r=d.useCallback(()=>{if(e)return E.getGenerationByName(`generation-${e}`)},[e]),{data:t,isLoading:c,error:a}=O(r);return{data:d.useMemo(()=>e?(t==null?void 0:t.pokemon_species.map(l=>({id:Number(l.url.split("https://pokeapi.co/api/v2/pokemon-species/")[1].split("/")[0]),name:l.name})).filter(l=>l.id<1e4).sort((l,u)=>l.id-u.id))??[]:[],[t==null?void 0:t.pokemon_species,e]),isLoading:c,error:a}},le=e=>{const r=d.useCallback(()=>{if(e)return E.getTypeByName(e)},[e]),{data:t,isLoading:c,error:a}=O(r);return{data:d.useMemo(()=>e?(t==null?void 0:t.pokemon.map(l=>({id:Number(l.pokemon.url.split("https://pokeapi.co/api/v2/pokemon/")[1].split("/")[0]),name:l.pokemon.name})).filter(l=>l.id<1e4))??[]:[],[t==null?void 0:t.pokemon,e]),isLoading:c,error:a}},ie=e=>{const{getUrl:r}=y(),t=r("generation")??"",c=r("type")??"",a=!!r("onlyStarred"),n=r("q")??"",{data:l,isLoading:u}=ae(t),{data:o,isLoading:i}=le(c),{starredPokemon:p}=T(),g=d.useMemo(()=>{if(e)return l!=null&&l.length&&(o!=null&&o.length)?l.filter(f=>new Set(o.map(v=>v.id)).has(f.id)):l!=null&&l.length?l:o!=null&&o.length?e.filter(f=>new Set(o.map(v=>v.id)).has(f.id)):e},[e,l,o]),x=d.useMemo(()=>{if(g)return a?g==null?void 0:g.filter(f=>p.includes(f.name)):g},[g,a,p]);return{pokemonList:d.useMemo(()=>{if(x)return n.trim().length?x==null?void 0:x.filter(f=>f.name.includes(n.toLowerCase().trim())):x},[x,n]),isLoading:u||i,isFiltered:!!(t||c||a||n)}},b="https://pokeapi.co/api/v2/generation",$=[{name:"generation-i",url:`${b}/1/`},{name:"generation-ii",url:`${b}/2/`},{name:"generation-iii",url:`${b}/3/`},{name:"generation-iv",url:`${b}/4/`},{name:"generation-v",url:`${b}/5/`},{name:"generation-vi",url:`${b}/6/`},{name:"generation-vii",url:`${b}/7/`},{name:"generation-viii",url:`${b}/8/`},{name:"generation-ix",url:`${b}/9/`}],m="https://pokeapi.co/api/v2/type",S=[{name:"normal",url:`${m}/1/`},{name:"fighting",url:`${m}/2/`},{name:"flying",url:`${m}/3/`},{name:"poison",url:`${m}/4/`},{name:"ground",url:`${m}/5/`},{name:"rock",url:`${m}/6/`},{name:"bug",url:`${m}/7/`},{name:"ghost",url:`${m}/8/`},{name:"steel",url:`${m}/9/`},{name:"fire",url:`${m}/10/`},{name:"water",url:`${m}/11/`},{name:"grass",url:`${m}/12/`},{name:"electric",url:`${m}/13/`},{name:"psychic",url:`${m}/14/`},{name:"ice",url:`${m}/15/`},{name:"dragon",url:`${m}/16/`},{name:"dark",url:`${m}/17/`},{name:"fairy",url:`${m}/18/`}],ce=()=>{const[e,r]=d.useState(""),{getUrl:t,setUrl:c}=y();d.useEffect(()=>r(t("q")??""),[t]);const a=n=>{r(n),c("q",n)};return s.jsx("input",{type:"text",placeholder:"Search by Pokémon name",value:e,onChange:n=>a(n.target.value),className:"w-full rounded-xl border border-slate-400/70 bg-slate-100 py-2 text-center shadow-md transition-colors hover:bg-slate-200/75 hover:shadow-lg focus:shadow-lg dark:bg-slate-800 dark:hover:bg-slate-700/75"})};var L,D;function ue(){if(D)return L;D=1;function e(r,t,c){var a,n,l,u,o;t==null&&(t=100);function i(){var g=Date.now()-u;g<t&&g>=0?a=setTimeout(i,t-g):(a=null,c||(o=r.apply(l,n),l=n=null))}var p=function(){l=this,n=arguments,u=Date.now();var g=c&&!a;return a||(a=setTimeout(i,t)),g&&(o=r.apply(l,n),l=n=null),o};return p.clear=function(){a&&(clearTimeout(a),a=null)},p.flush=function(){a&&(o=r.apply(l,n),l=n=null,clearTimeout(a),a=null)},p}return e.debounce=e,L=e,L}var de=ue();const U=X(de);function me(e){let{debounce:r,scroll:t,polyfill:c,offsetSize:a}={debounce:0,scroll:!1,offsetSize:!1};const n=c||(typeof window>"u"?class{}:window.ResizeObserver);if(!n)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[l,u]=d.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=d.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:l}),i=r?typeof r=="number"?r:r.scroll:null,p=r?typeof r=="number"?r:r.resize:null,g=d.useRef(!1);d.useEffect(()=>(g.current=!0,()=>void(g.current=!1)));const[x,N,f]=d.useMemo(()=>{const h=()=>{if(!o.current.element)return;const{left:G,top:_,width:H,height:I,bottom:J,right:W,x:K,y:Q}=o.current.element.getBoundingClientRect(),j={left:G,top:_,width:H,height:I,bottom:J,right:W,x:K,y:Q};o.current.element instanceof HTMLElement&&a&&(j.height=o.current.element.offsetHeight,j.width=o.current.element.offsetWidth),Object.freeze(j),g.current&&!fe(o.current.lastBounds,j)&&u(o.current.lastBounds=j)};return[h,p?U(h,p):h,i?U(h,i):h]},[u,a,i,p]);function v(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(h=>h.removeEventListener("scroll",f,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null)}function F(){o.current.element&&(o.current.resizeObserver=new n(f),o.current.resizeObserver.observe(o.current.element),t&&o.current.scrollContainers&&o.current.scrollContainers.forEach(h=>h.addEventListener("scroll",f,{capture:!0,passive:!0})))}const B=h=>{!h||h===o.current.element||(v(),o.current.element=h,o.current.scrollContainers=q(h),F())};return he(f,!!t),ge(N),d.useEffect(()=>{v(),F()},[t,f,N]),d.useEffect(()=>v,[]),[B,l,x]}function ge(e){d.useEffect(()=>{const r=e;return window.addEventListener("resize",r),()=>void window.removeEventListener("resize",r)},[e])}function he(e,r){d.useEffect(()=>{if(r){const t=e;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[e,r])}function q(e){const r=[];if(!e||e===document.body)return r;const{overflow:t,overflowX:c,overflowY:a}=window.getComputedStyle(e);return[t,c,a].some(n=>n==="auto"||n==="scroll")&&r.push(e),[...r,...q(e.parentElement)]}const pe=["x","y","top","bottom","left","right","width","height"],fe=(e,r)=>pe.every(t=>e[t]===r[t]),be={height:({isOpen:e,height:r})=>({height:e?r||"auto":0})},M=({name:e,values:r,renderLabel:t,isOpen:c,toggleOpen:a})=>{const{getUrl:n,setUrl:l}=y(),[u,{height:o}]=me();return s.jsxs("div",{className:"my-4 overflow-hidden rounded-xl border-2 border-slate-400/30 bg-slate-50 shadow-sm transition-colors dark:bg-slate-900",children:[s.jsxs("div",{onClick:a,className:"flex cursor-pointer items-center justify-between px-3 py-2 hover:bg-slate-400/10",children:[s.jsxs("h2",{className:"text-lg font-bold capitalize",children:[e," Filtering"]}),s.jsx(C.div,{initial:{rotate:c?180:0},animate:{rotate:c?180:0},transition:{type:Y,bounce:0,duration:.5},children:s.jsx(Z,{})})]}),s.jsx(C.div,{variants:be,custom:{isOpen:c,height:o},initial:"height",animate:"height",className:"overflow-hidden",children:s.jsx(ee,{children:c&&s.jsx(C.div,{ref:u,exit:{opacity:2},className:"grid grid-cols-3 gap-2 border-t-2 border-t-slate-400/30 p-2 lg:grid-cols-2 xl:grid-cols-3",children:r==null?void 0:r.map(i=>s.jsx(w,{onClick:()=>l(e,i),style:n(e)===i?"indigo":"normal",className:"capitalize",children:t(i)},i))})})})]})},xe=()=>{const e=k(i=>i.isGenFilterOpen),r=k(i=>i.toggleGenFilterOpen),t=k(i=>i.isTypeFilterOpen),c=k(i=>i.toggleTypeFilterOpen),a=A(),{getUrl:n,setUrl:l}=y(),u=!n("generation")&&!n("type")&&!n("onlyStarred")&&!n("q"),{length:o}=T();return s.jsxs("aside",{className:"p-4 lg:fixed lg:h-[calc(100vh-96px)] lg:w-1/5 lg:overflow-y-scroll lg:border-r lg:border-slate-400 dark:lg:border-slate-600",children:[s.jsx(ce,{}),s.jsx(M,{name:"generation",values:$==null?void 0:$.map(i=>i.name.split("-")[1]),renderLabel:i=>`Gen. ${i.toUpperCase()}`,isOpen:e,toggleOpen:r}),s.jsx(M,{name:"type",values:S==null?void 0:S.map(i=>i.name),renderLabel:i=>i,isOpen:t,toggleOpen:c}),s.jsxs(w,{onClick:()=>l("onlyStarred","true"),style:n("onlyStarred")?"gold":"normal",className:`mb-4 w-full ${n("onlyStarred")&&"py-[9.5px]"}`,children:["Show",n("onlyStarred")?`ing ${o}`:" only"," starred Pokémon"]}),s.jsx(w,{onClick:()=>void a("/pokedex/pokemon"),disabled:u,style:u?"normal":"indigo",className:"mb-4 w-full enabled:py-[9.5px] disabled:cursor-not-allowed disabled:opacity-25",children:"Clear Filtering"})]})},ve=({noOfPages:e,noOfSideButtons:r})=>{const{getUrl:t,setUrl:c}=y(),a=Number(t("page"))||1,n=u=>c("page",u.toString()),l=()=>{const u=[];let o=0;for(let i=a-r;i<=a+r;i++)o--,u.push(i>0&&i<=e?i:o);return u};return s.jsxs("div",{className:"flex gap-2 sm:gap-4",children:[s.jsx(w,{onClick:()=>n(1),disabled:a===1,className:"flex h-8 w-8 items-center justify-center rounded-full disabled:cursor-not-allowed disabled:opacity-25 sm:h-12 sm:w-12",children:s.jsx(te,{size:20})}),l().map(u=>u>0?s.jsx(w,{onClick:()=>n(u),disabled:u===a,style:u===a?"indigo":"normal",className:"flex h-8 w-8 items-center justify-center rounded-full disabled:cursor-default sm:h-12 sm:w-12",children:u},u):s.jsx("div",{className:"h-8 w-8 sm:h-12 sm:w-12"},u)),s.jsx(w,{onClick:()=>n(e),disabled:a===e,className:"flex h-8 w-8 items-center justify-center rounded-full disabled:cursor-not-allowed disabled:opacity-25 sm:h-12 sm:w-12",children:s.jsx(re,{size:20})})]})},we=({type:e})=>{const r=A();return s.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 text-center lg:h-screen",children:[s.jsxs("h2",{className:"text-3xl font-bold",children:["No ",e," Found"]}),s.jsx("p",{className:"mb-2 font-semibold text-slate-600 dark:text-slate-400",children:"Try other filtering options or another search query"}),s.jsx(w,{onClick:()=>void r("/pokedex/pokemon"),style:"indigo",className:"w-full",children:"Clear Filtering"})]})},ye=({id:e,name:r})=>{const{data:t}=ne(e),[c,a]=d.useState(!0);return s.jsx(se,{to:`/pokedex/pokemon/${r}`,state:{pokemon:t},children:s.jsxs("article",{className:"relative rounded-sm border border-slate-400/40 bg-slate-100 shadow-lg transition-colors hover:bg-slate-200/75 hover:shadow-xl dark:bg-slate-800 dark:hover:bg-slate-700/75",children:[s.jsx("img",{src:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/home/${e}.png`,alt:r,onLoad:()=>a(!1),className:"aspect-square w-full object-contain text-transparent dark:brightness-90"}),c?s.jsx("div",{className:"absolute top-0 aspect-square w-full bg-slate-100 dark:bg-slate-800",children:s.jsx(R,{size:8})}):"",s.jsxs("div",{className:"p-4",children:[s.jsxs("h1",{className:"text-lg font-bold text-nowrap capitalize md:text-xl",children:[e,". ",r]}),s.jsx("p",{className:"text-sm font-semibold text-nowrap text-slate-500 md:text-base dark:text-slate-400",children:t?s.jsxs(s.Fragment,{children:[(t==null?void 0:t.types.length)===1?"Type: ":"Types: ",t==null?void 0:t.types.map(n=>s.jsx("span",{className:"capitalize",children:` ${n.type.name}`},n.type.name))]}):"Loading..."})]})]})})},z=({children:e,to:r})=>s.jsx("a",{href:r,target:"_blank",rel:"noreferrer",className:"transition-all hover:border-b hover:text-gray-600 dark:hover:text-gray-300",children:e}),je=()=>s.jsxs("footer",{className:"mt-4 text-center text-sm text-gray-500 transition-colors dark:text-gray-400",children:["Made by"," ",s.jsx(z,{to:"https://github.com/AndreiJoroveanu",children:"Andrei Joroveanu"})," (",s.jsx(z,{to:"https://github.com/AndreiJoroveanu/pokedex",children:"Github repo"}),"). Data from ",s.jsx(z,{to:"https://pokeapi.co",children:"PokéAPI"}),"."]}),P=20,$e=()=>{const{data:e,isLoading:r}=oe(),{pokemonList:t,isLoading:c,isFiltered:a}=ie(e),n=(t==null?void 0:t.length)??0,l=Math.ceil(n/P),{getUrl:u}=y(),o=Number(u("page"))||1,i=d.useMemo(()=>t==null?void 0:t.slice((o-1)*P,o*P),[o,t]);return s.jsxs("div",{className:"relative pt-24",children:[s.jsx(xe,{}),s.jsxs("section",{className:"flex w-full flex-col items-center p-4 lg:absolute lg:right-0 lg:w-4/5",children:[!r&&!c?s.jsxs(s.Fragment,{children:[l>1&&s.jsx(ve,{noOfPages:l,noOfSideButtons:3}),i!=null&&i.length?s.jsxs(s.Fragment,{children:[s.jsx("main",{className:"mt-4 grid w-full grid-cols-2 gap-4 md:grid-cols-4 xl:grid-cols-5",children:i.map(p=>s.jsx(ye,{id:p.id,name:p.name},p.name))}),s.jsx(je,{})]}):null]}):s.jsx("div",{className:"fixed top-0 flex h-screen w-full items-center justify-center bg-slate-50 lg:-z-10 dark:bg-slate-900",children:s.jsx(R,{size:24,displaysText:!0})}),!(t!=null&&t.length)&&a&&s.jsx("div",{className:"top-0 lg:fixed lg:h-screen",children:s.jsx(we,{type:"Pokémon"})})]})]})};export{$e as default};
