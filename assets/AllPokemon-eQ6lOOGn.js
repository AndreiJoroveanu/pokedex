import{r as u,u as W,j as r,m as $,s as X,H as K,A as Q,a as N,b as U,c as V,d as Y,L as Z,e as M}from"./index-CIO1DR3c.js";import{a as P,u as z,b as A,B as w,c as ee}from"./useSpecificPokemon-cwVAGHkw.js";const te=()=>{const e=u.useCallback(()=>P.getPokemonSpeciesList(),[]),{data:n,isLoading:t,error:c}=z(e);return{data:u.useMemo(()=>n==null?void 0:n.results.map(o=>({id:Number(o.url.split("https://pokeapi.co/api/v2/pokemon-species/")[1].split("/")[0]),name:o.name})),[n]),isLoading:t,error:c}},j=()=>{const[e,n]=W(),t=i=>e.get(i);return{getUrl:t,setUrl:(i,o)=>{t(i)===o||o===""?e.delete(i):e.set(i,o),i!=="page"&&e.get("page")&&e.delete("page");const l=new URLSearchParams;["page","generation","type","onlyStarred","q"].map(d=>{const a=e.get(d);a&&l.set(d,a)}),n(l)}}},re=e=>{const n=u.useCallback(()=>{if(e)return P.getGenerationByName(`generation-${e}`)},[e]),{data:t,isLoading:c,error:i}=z(n);return{data:u.useMemo(()=>e?(t==null?void 0:t.pokemon_species.map(l=>({id:Number(l.url.split("https://pokeapi.co/api/v2/pokemon-species/")[1].split("/")[0]),name:l.name})).filter(l=>l.id<1e4).sort((l,s)=>l.id-s.id))??[]:[],[t==null?void 0:t.pokemon_species,e]),isLoading:c,error:i}},ne=e=>{const n=u.useCallback(()=>{if(e)return P.getTypeByName(e)},[e]),{data:t,isLoading:c,error:i}=z(n);return{data:u.useMemo(()=>e?(t==null?void 0:t.pokemon.map(l=>({id:Number(l.pokemon.url.split("https://pokeapi.co/api/v2/pokemon/")[1].split("/")[0]),name:l.pokemon.name})).filter(l=>l.id<1e4))??[]:[],[t==null?void 0:t.pokemon,e]),isLoading:c,error:i}},se=e=>{const{getUrl:n}=j(),t=n("generation")??"",c=n("type")??"",i=!!n("onlyStarred"),o=n("q")??"",{data:l,isLoading:s}=re(t),{data:d,isLoading:a}=ne(c),{starredPokemon:p}=A(),b=u.useMemo(()=>{if(e)return l!=null&&l.length&&(d!=null&&d.length)?l.filter(h=>new Set(d.map(y=>y.id)).has(h.id)):l!=null&&l.length?l:d!=null&&d.length?e.filter(h=>new Set(d.map(y=>y.id)).has(h.id)):e},[e,l,d]),f=u.useMemo(()=>{if(b)return i?b==null?void 0:b.filter(h=>p.includes(h.name)):b},[b,i,p]);return{pokemonList:u.useMemo(()=>{if(f)return o.trim().length?f==null?void 0:f.filter(h=>h.name.includes(o.toLowerCase().trim())):f},[f,o]),isLoading:s||a,isFiltered:!!(t||c||i||o)}},x="https://pokeapi.co/api/v2/generation",L=[{name:"generation-i",url:`${x}/1/`},{name:"generation-ii",url:`${x}/2/`},{name:"generation-iii",url:`${x}/3/`},{name:"generation-iv",url:`${x}/4/`},{name:"generation-v",url:`${x}/5/`},{name:"generation-vi",url:`${x}/6/`},{name:"generation-vii",url:`${x}/7/`},{name:"generation-viii",url:`${x}/8/`},{name:"generation-ix",url:`${x}/9/`}],m="https://pokeapi.co/api/v2/type",C=[{name:"normal",url:`${m}/1/`},{name:"fighting",url:`${m}/2/`},{name:"flying",url:`${m}/3/`},{name:"poison",url:`${m}/4/`},{name:"ground",url:`${m}/5/`},{name:"rock",url:`${m}/6/`},{name:"bug",url:`${m}/7/`},{name:"ghost",url:`${m}/8/`},{name:"steel",url:`${m}/9/`},{name:"fire",url:`${m}/10/`},{name:"water",url:`${m}/11/`},{name:"grass",url:`${m}/12/`},{name:"electric",url:`${m}/13/`},{name:"psychic",url:`${m}/14/`},{name:"ice",url:`${m}/15/`},{name:"dragon",url:`${m}/16/`},{name:"dark",url:`${m}/17/`},{name:"fairy",url:`${m}/18/`}],oe=()=>{const[e,n]=u.useState(""),{getUrl:t,setUrl:c}=j();u.useEffect(()=>n(t("q")??""),[t]);const i=o=>{n(o),c("q",o)};return r.jsx("input",{type:"text",placeholder:"Search by Pokémon name",value:e,onChange:o=>i(o.target.value),className:"w-full rounded-xl border border-slate-400/70 bg-slate-100 py-2 text-center shadow-md transition-colors hover:bg-slate-200/75 hover:shadow-lg focus:shadow-lg dark:bg-slate-800 dark:shadow-none dark:hover:bg-slate-700/75 dark:hover:shadow-none dark:focus:shadow-none"})};function F(e,n){let t;return(...c)=>{window.clearTimeout(t),t=window.setTimeout(()=>e(...c),n)}}function ae({debounce:e,scroll:n,polyfill:t,offsetSize:c}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,l]=u.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),s=u.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o,orientationHandler:null}),d=e?typeof e=="number"?e:e.scroll:null,a=e?typeof e=="number"?e:e.resize:null,p=u.useRef(!1);u.useEffect(()=>(p.current=!0,()=>void(p.current=!1)));const[b,f,v]=u.useMemo(()=>{const g=()=>{if(!s.current.element)return;const{left:T,top:R,width:B,height:q,bottom:G,right:I,x:_,y:J}=s.current.element.getBoundingClientRect(),k={left:T,top:R,width:B,height:q,bottom:G,right:I,x:_,y:J};s.current.element instanceof HTMLElement&&c&&(k.height=s.current.element.offsetHeight,k.width=s.current.element.offsetWidth),Object.freeze(k),p.current&&!de(s.current.lastBounds,k)&&l(s.current.lastBounds=k)};return[g,a?F(g,a):g,d?F(g,d):g]},[l,c,d,a]);function h(){s.current.scrollContainers&&(s.current.scrollContainers.forEach(g=>g.removeEventListener("scroll",v,!0)),s.current.scrollContainers=null),s.current.resizeObserver&&(s.current.resizeObserver.disconnect(),s.current.resizeObserver=null),s.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",s.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",s.current.orientationHandler))}function y(){s.current.element&&(s.current.resizeObserver=new i(v),s.current.resizeObserver.observe(s.current.element),n&&s.current.scrollContainers&&s.current.scrollContainers.forEach(g=>g.addEventListener("scroll",v,{capture:!0,passive:!0})),s.current.orientationHandler=()=>{v()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",s.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",s.current.orientationHandler))}const H=g=>{!g||g===s.current.element||(h(),s.current.element=g,s.current.scrollContainers=D(g),y())};return le(v,!!n),ie(f),u.useEffect(()=>{h(),y()},[n,v,f]),u.useEffect(()=>h,[]),[H,o,b]}function ie(e){u.useEffect(()=>{const n=e;return window.addEventListener("resize",n),()=>void window.removeEventListener("resize",n)},[e])}function le(e,n){u.useEffect(()=>{if(n){const t=e;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[e,n])}function D(e){const n=[];if(!e||e===document.body)return n;const{overflow:t,overflowX:c,overflowY:i}=window.getComputedStyle(e);return[t,c,i].some(o=>o==="auto"||o==="scroll")&&n.push(e),[...n,...D(e.parentElement)]}const ce=["x","y","top","bottom","left","right","width","height"],de=(e,n)=>ce.every(t=>e[t]===n[t]),ue={height:({isOpen:e,height:n})=>({height:e?n||"auto":0})},O=({name:e,values:n,renderLabel:t,isOpen:c,toggleOpen:i})=>{const{getUrl:o,setUrl:l}=j(),[s,{height:d}]=ae();return r.jsxs("div",{className:"my-4 overflow-hidden rounded-xl border-2 border-slate-400/30 bg-slate-50 shadow-sm transition-colors dark:bg-slate-900 dark:shadow-none",children:[r.jsxs("div",{onClick:i,className:"flex cursor-pointer items-center justify-between px-3 py-2 hover:bg-slate-400/10",children:[r.jsxs("h2",{className:"text-lg font-bold capitalize",children:[e," Filtering"]}),r.jsx($.div,{initial:{rotate:c?180:0},animate:{rotate:c?180:0},transition:{type:X,bounce:0,duration:.5},children:r.jsx(K,{})})]}),r.jsx($.div,{variants:ue,custom:{isOpen:c,height:d},initial:"height",animate:"height",className:"overflow-hidden",children:r.jsx(Q,{children:c&&r.jsx($.div,{ref:s,exit:{opacity:2},className:"grid grid-cols-3 gap-2 border-t-2 border-t-slate-400/30 p-2 lg:grid-cols-2 xl:grid-cols-3",children:n==null?void 0:n.map(a=>r.jsx(w,{onClick:()=>l(e,a),style:o(e)===a?"indigo":"normal",className:"capitalize",children:t(a)},a))})})})]})},me=()=>{const e=N(a=>a.isGenFilterOpen),n=N(a=>a.toggleGenFilterOpen),t=N(a=>a.isTypeFilterOpen),c=N(a=>a.toggleTypeFilterOpen),i=U(),{getUrl:o,setUrl:l}=j(),s=!o("generation")&&!o("type")&&!o("onlyStarred")&&!o("q"),{length:d}=A();return r.jsxs("aside",{className:"p-4 max-lg:pb-0 lg:fixed lg:h-[calc(100vh-96px)] lg:w-1/5 lg:overflow-y-scroll lg:border-r lg:border-slate-400 dark:lg:border-slate-600",children:[r.jsx(oe,{}),r.jsx(O,{name:"generation",values:L==null?void 0:L.map(a=>a.name.split("-")[1]),renderLabel:a=>`Gen. ${a.toUpperCase()}`,isOpen:e,toggleOpen:n}),r.jsx(O,{name:"type",values:C==null?void 0:C.map(a=>a.name),renderLabel:a=>a,isOpen:t,toggleOpen:c}),r.jsxs(w,{onClick:()=>l("onlyStarred","true"),style:o("onlyStarred")?"gold":"normal",className:`mb-4 w-full ${o("onlyStarred")&&"py-[9.5px]"}`,children:["Show",o("onlyStarred")?`ing ${d}`:" only"," starred Pokémon"]}),r.jsx(w,{onClick:()=>void i("/pokedex/pokemon"),disabled:s,style:s?"normal":"indigo",className:"w-full enabled:py-[9.5px] disabled:cursor-not-allowed disabled:opacity-25 lg:mb-4",children:"Clear Filtering"})]})},ge=({noOfPages:e,noOfSideButtons:n})=>{const{getUrl:t,setUrl:c}=j(),i=Number(t("page"))||1,o=s=>c("page",s.toString()),l=()=>{const s=[];let d=0;for(let a=i-n;a<=i+n;a++)d--,s.push(a>0&&a<=e?a:d);return s};return r.jsxs("div",{className:"flex gap-2 sm:gap-4",children:[r.jsx(w,{onClick:()=>o(1),disabled:i===1,className:"flex h-8 w-8 items-center justify-center rounded-full disabled:cursor-not-allowed disabled:opacity-25 sm:h-12 sm:w-12",children:r.jsx(V,{size:20})}),l().map(s=>s>0?r.jsx(w,{onClick:()=>o(s),disabled:s===i,style:s===i?"indigo":"normal",className:"flex h-8 w-8 items-center justify-center rounded-full disabled:cursor-default sm:h-12 sm:w-12",children:s},s):r.jsx("div",{className:"h-8 w-8 sm:h-12 sm:w-12"},s)),r.jsx(w,{onClick:()=>o(e),disabled:i===e,className:"flex h-8 w-8 items-center justify-center rounded-full disabled:cursor-not-allowed disabled:opacity-25 sm:h-12 sm:w-12",children:r.jsx(Y,{size:20})})]})},he=({type:e})=>{const n=U();return r.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-8 text-center lg:h-screen",children:[r.jsxs("h2",{className:"text-3xl font-bold",children:["No ",e," Found"]}),r.jsx("p",{className:"mb-2 font-semibold text-slate-600 dark:text-slate-400",children:"Try other filtering options or another search query"}),r.jsx(w,{onClick:()=>void n("/pokedex/pokemon"),style:"indigo",className:"w-full max-lg:hidden",children:"Clear Filtering"})]})},pe=({id:e,name:n})=>{const{data:t}=ee(e),[c,i]=u.useState(!0);return r.jsx(Z,{to:`/pokedex/pokemon/${n}`,state:{pokemon:t},children:r.jsxs("article",{className:"relative rounded-sm border border-slate-400/40 bg-slate-100 shadow-lg transition-colors hover:bg-slate-200/75 hover:shadow-xl dark:bg-slate-800 dark:shadow-none dark:hover:bg-slate-700/75 dark:hover:shadow-none",children:[r.jsx("img",{src:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/home/${e}.png`,alt:n,onLoad:()=>i(!1),className:"aspect-square w-full object-contain text-transparent dark:brightness-90"}),c?r.jsx("div",{className:"absolute top-0 aspect-square w-full bg-slate-100 dark:bg-slate-800",children:r.jsx(M,{size:8})}):"",r.jsxs("div",{className:"px-3 py-2 md:p-4",children:[r.jsxs("h1",{className:"text-base font-bold text-nowrap capitalize sm:text-lg md:text-xl",children:[e,". ",n]}),r.jsx("p",{className:"text-sm font-semibold text-nowrap text-slate-500 md:text-base dark:text-slate-400",children:t?r.jsxs(r.Fragment,{children:[(t==null?void 0:t.types.length)===1?"Type: ":"Types: ",t==null?void 0:t.types.map(o=>r.jsx("span",{className:"capitalize",children:` ${o.type.name}`},o.type.name))]}):"Loading..."})]})]})})},S=({children:e,to:n})=>r.jsx("a",{href:n,target:"_blank",rel:"noreferrer",className:"transition-all hover:border-b hover:text-gray-600 dark:hover:text-gray-300",children:e}),fe=()=>r.jsxs("footer",{className:"mt-4 text-center text-sm text-gray-500 transition-colors dark:text-gray-400",children:["Made by"," ",r.jsx(S,{to:"https://github.com/AndreiJoroveanu",children:"Andrei Joroveanu"})," (",r.jsx(S,{to:"https://github.com/AndreiJoroveanu/pokedex",children:"Github repo"}),"). Data from ",r.jsx(S,{to:"https://pokeapi.co",children:"PokéAPI"}),"."]}),E=20,ve=()=>{const{data:e,isLoading:n}=te(),{pokemonList:t,isLoading:c,isFiltered:i}=se(e),o=(t==null?void 0:t.length)??0,l=Math.ceil(o/E),{getUrl:s}=j(),d=Number(s("page"))||1,a=u.useMemo(()=>t==null?void 0:t.slice((d-1)*E,d*E),[d,t]);return r.jsxs("div",{className:"relative pt-18 sm:pt-24",children:[r.jsx(me,{}),r.jsxs("section",{className:"flex w-full flex-col items-center p-4 lg:absolute lg:right-0 lg:w-4/5",children:[!n&&!c?r.jsxs(r.Fragment,{children:[l>1&&r.jsx(ge,{noOfPages:l,noOfSideButtons:3}),a!=null&&a.length?r.jsxs(r.Fragment,{children:[r.jsx("main",{className:"mt-4 grid w-full grid-cols-2 gap-4 md:grid-cols-4 xl:grid-cols-5",children:a.map(p=>r.jsx(pe,{id:p.id,name:p.name},p.name))}),r.jsx(fe,{})]}):null]}):r.jsx("div",{className:"fixed top-0 flex h-screen w-full items-center justify-center bg-slate-50 lg:-z-10 dark:bg-slate-900",children:r.jsx(M,{size:24,displaysText:!0})}),!(t!=null&&t.length)&&i&&r.jsx("div",{className:"top-0 lg:fixed lg:h-screen",children:r.jsx(he,{type:"Pokémon"})})]})]})};export{ve as default};
