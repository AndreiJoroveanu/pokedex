import{r as d,u as Q,j as s,g as V,m as N,s as X,H as Y,A as Z,a as y,b as A,c as ee,d as te,L as re,e as R}from"./index-Co6U4wFH.js";import{a as S,u as E,B as b,b as se}from"./useSpecificPokemon-Cdr2R3i9.js";const ne=()=>{const e=d.useCallback(()=>S.getPokemonSpeciesList(),[]),{data:r,isLoading:t,error:c}=E(e);return{data:d.useMemo(()=>r==null?void 0:r.results.map(n=>({id:Number(n.url.split("https://pokeapi.co/api/v2/pokemon-species/")[1].split("/")[0]),name:n.name})),[r]),isLoading:t,error:c}},x=()=>{const[e,r]=Q(),t=o=>e.get(o);return{getUrl:t,setUrl:(o,n)=>{t(o)===n||n===""?e.delete(o):e.set(o,n),o!=="page"&&e.get("page")&&e.delete("page");const a=new URLSearchParams;["page","generation","type","q"].map(l=>{const u=e.get(l);u&&a.set(l,u)}),r(a)}}},oe=e=>{const r=d.useCallback(()=>{if(e)return S.getGenerationByName(`generation-${e}`)},[e]),{data:t,isLoading:c,error:o}=E(r);return{data:d.useMemo(()=>e?(t==null?void 0:t.pokemon_species.map(a=>({id:Number(a.url.split("https://pokeapi.co/api/v2/pokemon-species/")[1].split("/")[0]),name:a.name})).filter(a=>a.id<1e4).sort((a,i)=>a.id-i.id))??[]:[],[t==null?void 0:t.pokemon_species,e]),isLoading:c,error:o}},ae=e=>{const r=d.useCallback(()=>{if(e)return S.getTypeByName(e)},[e]),{data:t,isLoading:c,error:o}=E(r);return{data:d.useMemo(()=>e?(t==null?void 0:t.pokemon.map(a=>({id:Number(a.pokemon.url.split("https://pokeapi.co/api/v2/pokemon/")[1].split("/")[0]),name:a.pokemon.name})).filter(a=>a.id<1e4))??[]:[],[t==null?void 0:t.pokemon,e]),isLoading:c,error:o}},le=e=>{const{getUrl:r}=x(),t=r("generation")??"",c=r("type")??"",o=r("q")??"",{data:n,isLoading:a}=oe(t),{data:i,isLoading:l}=ae(c),u=d.useMemo(()=>{if(e)return n!=null&&n.length&&(i!=null&&i.length)?n.filter(g=>new Set(i.map(v=>v.id)).has(g.id)):n!=null&&n.length?n:i!=null&&i.length?e.filter(g=>new Set(i.map(v=>v.id)).has(g.id)):e},[e,n,i]);return{pokemonList:d.useMemo(()=>o.trim().length?u==null?void 0:u.filter(g=>g.name.toLowerCase().includes(o.toLowerCase().trim())):u,[u,o]),isLoading:a||l,isFiltered:!!(t||c||o)}},f="https://pokeapi.co/api/v2/generation",C=[{name:"generation-i",url:`${f}/1/`},{name:"generation-ii",url:`${f}/2/`},{name:"generation-iii",url:`${f}/3/`},{name:"generation-iv",url:`${f}/4/`},{name:"generation-v",url:`${f}/5/`},{name:"generation-vi",url:`${f}/6/`},{name:"generation-vii",url:`${f}/7/`},{name:"generation-viii",url:`${f}/8/`},{name:"generation-ix",url:`${f}/9/`}],m="https://pokeapi.co/api/v2/type",$=[{name:"normal",url:`${m}/1/`},{name:"fighting",url:`${m}/2/`},{name:"flying",url:`${m}/3/`},{name:"poison",url:`${m}/4/`},{name:"ground",url:`${m}/5/`},{name:"rock",url:`${m}/6/`},{name:"bug",url:`${m}/7/`},{name:"ghost",url:`${m}/8/`},{name:"steel",url:`${m}/9/`},{name:"fire",url:`${m}/10/`},{name:"water",url:`${m}/11/`},{name:"grass",url:`${m}/12/`},{name:"electric",url:`${m}/13/`},{name:"psychic",url:`${m}/14/`},{name:"ice",url:`${m}/15/`},{name:"dragon",url:`${m}/16/`},{name:"dark",url:`${m}/17/`},{name:"fairy",url:`${m}/18/`}],ie=()=>{const[e,r]=d.useState(""),{getUrl:t,setUrl:c}=x();d.useEffect(()=>r(t("q")??""),[t]);const o=n=>{r(n),c("q",n)};return s.jsx("input",{type:"text",placeholder:"Search by Pokémon name",value:e,onChange:n=>o(n.target.value),className:"w-full rounded-xl border border-slate-400/70 bg-slate-100 py-2 text-center shadow-md transition-colors hover:bg-slate-200/75 hover:shadow-lg focus:shadow-lg dark:bg-slate-800 dark:hover:bg-slate-700/75"})};var L,D;function ce(){if(D)return L;D=1;function e(r,t,c){var o,n,a,i,l;t==null&&(t=100);function u(){var g=Date.now()-i;g<t&&g>=0?o=setTimeout(u,t-g):(o=null,c||(l=r.apply(a,n),a=n=null))}var p=function(){a=this,n=arguments,i=Date.now();var g=c&&!o;return o||(o=setTimeout(u,t)),g&&(l=r.apply(a,n),a=n=null),l};return p.clear=function(){o&&(clearTimeout(o),o=null)},p.flush=function(){o&&(l=r.apply(a,n),a=n=null,clearTimeout(o),o=null)},p}return e.debounce=e,L=e,L}var ue=ce();const U=V(ue);function de(e){let{debounce:r,scroll:t,polyfill:c,offsetSize:o}={debounce:0,scroll:!1,offsetSize:!1};const n=c||(typeof window>"u"?class{}:window.ResizeObserver);if(!n)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,i]=d.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=d.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a}),u=r?typeof r=="number"?r:r.scroll:null,p=r?typeof r=="number"?r:r.resize:null,g=d.useRef(!1);d.useEffect(()=>(g.current=!0,()=>void(g.current=!1)));const[v,O,w]=d.useMemo(()=>{const h=()=>{if(!l.current.element)return;const{left:B,top:G,width:_,height:H,bottom:I,right:J,x:W,y:K}=l.current.element.getBoundingClientRect(),j={left:B,top:G,width:_,height:H,bottom:I,right:J,x:W,y:K};l.current.element instanceof HTMLElement&&o&&(j.height=l.current.element.offsetHeight,j.width=l.current.element.offsetWidth),Object.freeze(j),g.current&&!pe(l.current.lastBounds,j)&&i(l.current.lastBounds=j)};return[h,p?U(h,p):h,u?U(h,u):h]},[i,o,u,p]);function k(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(h=>h.removeEventListener("scroll",w,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function F(){l.current.element&&(l.current.resizeObserver=new n(w),l.current.resizeObserver.observe(l.current.element),t&&l.current.scrollContainers&&l.current.scrollContainers.forEach(h=>h.addEventListener("scroll",w,{capture:!0,passive:!0})))}const q=h=>{!h||h===l.current.element||(k(),l.current.element=h,l.current.scrollContainers=T(h),F())};return ge(w,!!t),me(O),d.useEffect(()=>{k(),F()},[t,w,O]),d.useEffect(()=>k,[]),[q,a,v]}function me(e){d.useEffect(()=>{const r=e;return window.addEventListener("resize",r),()=>void window.removeEventListener("resize",r)},[e])}function ge(e,r){d.useEffect(()=>{if(r){const t=e;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[e,r])}function T(e){const r=[];if(!e||e===document.body)return r;const{overflow:t,overflowX:c,overflowY:o}=window.getComputedStyle(e);return[t,c,o].some(n=>n==="auto"||n==="scroll")&&r.push(e),[...r,...T(e.parentElement)]}const he=["x","y","top","bottom","left","right","width","height"],pe=(e,r)=>he.every(t=>e[t]===r[t]),fe={height:({isOpen:e,height:r})=>({height:e?r||"auto":0})},M=({name:e,values:r,renderLabel:t,isOpen:c,toggleOpen:o})=>{const{getUrl:n,setUrl:a}=x(),[i,{height:l}]=de();return s.jsxs("div",{className:"my-4 overflow-hidden rounded-xl border-2 border-slate-400/30 bg-slate-50 shadow-sm transition-colors dark:bg-slate-900",children:[s.jsxs("div",{onClick:o,className:"flex cursor-pointer items-center justify-between px-3 py-2 hover:bg-slate-400/10",children:[s.jsxs("h2",{className:"text-lg font-bold capitalize",children:[e," Filtering"]}),s.jsx(N.div,{initial:{rotate:c?180:0},animate:{rotate:c?180:0},transition:{type:X,bounce:0,duration:.5},children:s.jsx(Y,{})})]}),s.jsx(N.div,{variants:fe,custom:{isOpen:c,height:l},initial:"height",animate:"height",className:"overflow-hidden",children:s.jsx(Z,{children:c&&s.jsx(N.div,{ref:i,exit:{opacity:2},className:"grid grid-cols-3 gap-2 border-t-2 border-t-slate-400/30 p-2 lg:grid-cols-2 xl:grid-cols-3",children:r==null?void 0:r.map(u=>s.jsx(b,{onClick:()=>a(e,u),isSelected:n(e)===u,className:"capitalize",children:t(u)},u))})})})]})},be=()=>{const e=y(a=>a.isGenFilterOpen),r=y(a=>a.toggleGenFilterOpen),t=y(a=>a.isTypeFilterOpen),c=y(a=>a.toggleTypeFilterOpen),o=A(),{getUrl:n}=x();return s.jsxs("aside",{className:"p-4 lg:fixed lg:h-[calc(100vh-96px)] lg:w-1/5 lg:overflow-y-scroll lg:border-r lg:border-slate-400 dark:lg:border-slate-600",children:[s.jsx(ie,{}),s.jsx(M,{name:"generation",values:C==null?void 0:C.map(a=>a.name.split("-")[1]),renderLabel:a=>`Gen. ${a.toUpperCase()}`,isOpen:e,toggleOpen:r}),s.jsx(M,{name:"type",values:$==null?void 0:$.map(a=>a.name),renderLabel:a=>a,isOpen:t,toggleOpen:c}),s.jsx(b,{onClick:()=>void o("/pokedex/pokemon"),disabled:!n("generation")&&!n("type")&&!n("q"),isSelected:!!(n("generation")??n("type")??n("q")),className:"mb-4 w-full enabled:py-[9.5px] disabled:cursor-not-allowed disabled:opacity-25",children:"Clear Filtering"})]})},xe=({noOfPages:e,noOfSideButtons:r})=>{const{getUrl:t,setUrl:c}=x(),o=Number(t("page"))||1,n=i=>c("page",i.toString()),a=()=>{const i=[];let l=0;for(let u=o-r;u<=o+r;u++)l--,i.push(u>0&&u<=e?u:l);return i};return s.jsxs("div",{className:"flex gap-2 sm:gap-4",children:[s.jsx(b,{onClick:()=>n(1),disabled:o===1,className:"flex h-8 w-8 items-center justify-center rounded-full disabled:cursor-not-allowed disabled:opacity-25 sm:h-12 sm:w-12",children:s.jsx(ee,{size:20})}),a().map(i=>i>0?s.jsx(b,{onClick:()=>n(i),disabled:i===o,isSelected:i===o,className:"flex h-8 w-8 items-center justify-center rounded-full disabled:cursor-default sm:h-12 sm:w-12",children:i},i):s.jsx("div",{className:"h-8 w-8 sm:h-12 sm:w-12"},i)),s.jsx(b,{onClick:()=>n(e),disabled:o===e,className:"flex h-8 w-8 items-center justify-center rounded-full disabled:cursor-not-allowed disabled:opacity-25 sm:h-12 sm:w-12",children:s.jsx(te,{size:20})})]})},ve=({type:e})=>{const r=A();return s.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 text-center lg:h-screen",children:[s.jsxs("h2",{className:"text-3xl font-bold",children:["No ",e," Found"]}),s.jsx("p",{className:"mb-2 font-semibold text-slate-600 dark:text-slate-400",children:"Try other filtering options or another search query"}),s.jsx(b,{onClick:()=>void r("/pokedex/pokemon"),isSelected:!0,className:"w-full",children:"Clear Filtering"})]})},we=({id:e,name:r})=>{const{data:t}=se(e),[c,o]=d.useState(!0);return s.jsx(re,{to:`/pokedex/pokemon/${r}`,state:{pokemon:t},children:s.jsxs("article",{className:"relative rounded-sm border border-slate-400/40 bg-slate-100 shadow-lg transition-colors hover:bg-slate-200/75 hover:shadow-xl dark:bg-slate-800 dark:hover:bg-slate-700/75",children:[s.jsx("img",{src:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/home/${e}.png`,alt:r,onLoad:()=>o(!1),className:"aspect-square w-full object-contain text-transparent dark:brightness-90"}),c?s.jsx("div",{className:"absolute top-0 aspect-square w-full bg-slate-100 dark:bg-slate-800",children:s.jsx(R,{size:8})}):"",s.jsxs("div",{className:"p-4",children:[s.jsxs("h1",{className:"text-lg font-bold text-nowrap capitalize md:text-xl",children:[e,". ",r]}),s.jsx("p",{className:"text-sm font-semibold text-nowrap text-slate-500 md:text-base dark:text-slate-400",children:t?s.jsxs(s.Fragment,{children:[(t==null?void 0:t.types.length)===1?"Type: ":"Types: ",t==null?void 0:t.types.map(n=>s.jsx("span",{className:"capitalize",children:` ${n.type.name}`},n.type.name))]}):"Loading..."})]})]})})},z=({children:e,to:r})=>s.jsx("a",{href:r,target:"_blank",rel:"noreferrer",className:"transition-all hover:border-b hover:text-gray-600 dark:hover:text-gray-300",children:e}),je=()=>s.jsxs("footer",{className:"mt-4 text-center text-sm text-gray-500 transition-colors dark:text-gray-400",children:["Made by"," ",s.jsx(z,{to:"https://github.com/AndreiJoroveanu",children:"Andrei Joroveanu"})," (",s.jsx(z,{to:"https://github.com/AndreiJoroveanu/pokedex",children:"Github repo"}),"). Data from ",s.jsx(z,{to:"https://pokeapi.co",children:"PokéAPI"}),"."]}),P=20,Ce=()=>{const{data:e,isLoading:r}=ne(),{pokemonList:t,isLoading:c,isFiltered:o}=le(e),n=(t==null?void 0:t.length)??0,a=Math.ceil(n/P),{getUrl:i}=x(),l=Number(i("page"))||1,u=d.useMemo(()=>t==null?void 0:t.slice((l-1)*P,l*P),[l,t]);return s.jsxs("div",{className:"relative pt-24",children:[s.jsx(be,{}),s.jsxs("section",{className:"flex w-full flex-col items-center p-4 lg:absolute lg:right-0 lg:w-4/5",children:[!r&&!c?s.jsxs(s.Fragment,{children:[a>1&&s.jsx(xe,{noOfPages:a,noOfSideButtons:3}),u!=null&&u.length?s.jsxs(s.Fragment,{children:[s.jsx("main",{className:"mt-4 grid w-full grid-cols-2 gap-4 md:grid-cols-4 xl:grid-cols-5",children:u.map(p=>s.jsx(we,{id:p.id,name:p.name},p.name))}),s.jsx(je,{})]}):null]}):s.jsx("div",{className:"fixed top-0 flex h-screen w-full items-center justify-center bg-slate-50 lg:-z-10 dark:bg-slate-900",children:s.jsx(R,{size:24,displaysText:!0})}),!(t!=null&&t.length)&&o&&s.jsx("div",{className:"top-0 lg:fixed lg:h-screen",children:s.jsx(ve,{type:"Pokémon"})})]})]})};export{Ce as default};
