import{r as m,u as O,j as r,a as j,b as F,L as z,c as S}from"./index-KGuPi_Zu.js";import{a as P,u as C,b as U,C as E,B as h,c as A,P as D}from"./PokemonTypesDisplayText-BAQK_X2W.js";function M({title:e,titleId:t,...s},d){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":t},s),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.75 4.5-7.5 7.5 7.5 7.5m-6-15L5.25 12l7.5 7.5"}))}const q=m.forwardRef(M);function R({title:e,titleId:t,...s},d){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":t},s),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m5.25 4.5 7.5 7.5-7.5 7.5m6-15 7.5 7.5-7.5 7.5"}))}const T=m.forwardRef(R),G=()=>{const e=m.useCallback(()=>P.getPokemonSpeciesList(),[]),{data:t,isLoading:s,error:d}=C(e);return{data:m.useMemo(()=>t==null?void 0:t.results.map(a=>({id:Number(a.url.split("https://pokeapi.co/api/v2/pokemon-species/")[1].split("/")[0]),name:a.name})),[t]),isLoading:s,error:d}},k=()=>{const[e,t]=O(),s=o=>e.get(o);return{getUrl:s,setUrl:(o,a)=>{s(o)===a||a===""?e.delete(o):e.set(o,a),o!=="page"&&e.get("page")&&e.delete("page");const n=new URLSearchParams;["page","generation","type","onlyStarred","q"].map(c=>{const l=e.get(c);l&&n.set(c,l)}),t(n)}}},I=e=>{const t=m.useCallback(()=>{if(e)return P.getGenerationByName(`generation-${e}`)},[e]),{data:s,isLoading:d,error:o}=C(t);return{data:m.useMemo(()=>e?(s==null?void 0:s.pokemon_species.map(n=>({id:Number(n.url.split("https://pokeapi.co/api/v2/pokemon-species/")[1].split("/")[0]),name:n.name})).filter(n=>n.id<1e4).sort((n,i)=>n.id-i.id))??[]:[],[s==null?void 0:s.pokemon_species,e]),isLoading:d,error:o}},B=e=>{const t=m.useCallback(()=>{if(e)return P.getTypeByName(e)},[e]),{data:s,isLoading:d,error:o}=C(t);return{data:m.useMemo(()=>e?(s==null?void 0:s.pokemon.map(n=>({id:Number(n.pokemon.url.split("https://pokeapi.co/api/v2/pokemon/")[1].split("/")[0]),name:n.pokemon.name})).filter(n=>n.id<1e4))??[]:[],[s==null?void 0:s.pokemon,e]),isLoading:d,error:o}},_=e=>{const{getUrl:t}=k(),s=t("generation")??"",d=t("type")??"",o=!!t("onlyStarred"),a=t("q")??"",{data:n,isLoading:i}=I(s),{data:c,isLoading:l}=B(d),{starredPokemon:x}=U(),b=m.useMemo(()=>{if(e)return n!=null&&n.length&&(c!=null&&c.length)?n.filter(p=>new Set(c.map(y=>y.id)).has(p.id)):n!=null&&n.length?n:c!=null&&c.length?e.filter(p=>new Set(c.map(y=>y.id)).has(p.id)):e},[e,n,c]),f=m.useMemo(()=>{if(b)return o?b==null?void 0:b.filter(p=>x.includes(p.name)):b},[b,o,x]);return{pokemonList:m.useMemo(()=>{if(f)return a.trim().length?f==null?void 0:f.filter(p=>p.name.includes(a.toLowerCase().trim())):f},[f,a]),isLoading:i||l,isFiltered:!!(s||d||o||a)}},g="https://pokeapi.co/api/v2/generation",v=[{name:"generation-i",url:`${g}/1/`},{name:"generation-ii",url:`${g}/2/`},{name:"generation-iii",url:`${g}/3/`},{name:"generation-iv",url:`${g}/4/`},{name:"generation-v",url:`${g}/5/`},{name:"generation-vi",url:`${g}/6/`},{name:"generation-vii",url:`${g}/7/`},{name:"generation-viii",url:`${g}/8/`},{name:"generation-ix",url:`${g}/9/`}],u="https://pokeapi.co/api/v2/type",w=[{name:"normal",url:`${u}/1/`},{name:"fighting",url:`${u}/2/`},{name:"flying",url:`${u}/3/`},{name:"poison",url:`${u}/4/`},{name:"ground",url:`${u}/5/`},{name:"rock",url:`${u}/6/`},{name:"bug",url:`${u}/7/`},{name:"ghost",url:`${u}/8/`},{name:"steel",url:`${u}/9/`},{name:"fire",url:`${u}/10/`},{name:"water",url:`${u}/11/`},{name:"grass",url:`${u}/12/`},{name:"electric",url:`${u}/13/`},{name:"psychic",url:`${u}/14/`},{name:"ice",url:`${u}/15/`},{name:"dragon",url:`${u}/16/`},{name:"dark",url:`${u}/17/`},{name:"fairy",url:`${u}/18/`}],J=()=>{const[e,t]=m.useState(""),{getUrl:s,setUrl:d}=k();m.useEffect(()=>t(s("q")??""),[s]);const o=a=>{t(a),d("q",a)};return r.jsx("input",{type:"text",placeholder:"Search by Pokémon name",value:e,onChange:a=>o(a.target.value),className:"w-full rounded-xl border border-slate-400/70 bg-slate-100 py-2 text-center shadow-md transition-colors hover:bg-slate-200/75 hover:shadow-lg focus:shadow-lg dark:bg-slate-800 dark:shadow-none dark:hover:bg-slate-700/75 dark:hover:shadow-none dark:focus:shadow-none"})},L=({name:e,values:t,renderLabel:s,isOpen:d,toggleOpen:o})=>{const{getUrl:a,setUrl:n}=k();return r.jsx(E,{label:`${e} Filtering`,initialIsOpen:d,toggleOpen:o,className:"grid grid-cols-3 gap-2 p-2 lg:grid-cols-2 xl:grid-cols-3",children:t==null?void 0:t.map(i=>r.jsx(h,{onClick:()=>n(e,i),style:a(e)===i?"indigo":"normal",className:"capitalize",children:s(i)},i))})},W=()=>{const e=j(l=>l.isGenFilterOpen),t=j(l=>l.toggleGenFilterOpen),s=j(l=>l.isTypeFilterOpen),d=j(l=>l.toggleTypeFilterOpen),o=F(),{getUrl:a,setUrl:n}=k(),i=!a("generation")&&!a("type")&&!a("onlyStarred")&&!a("q"),{length:c}=U();return r.jsxs("aside",{className:"p-4 max-lg:pb-0 lg:fixed lg:h-[calc(100vh-96px)] lg:w-1/5 lg:overflow-y-scroll lg:border-r lg:border-slate-400 dark:lg:border-slate-600",children:[r.jsx(J,{}),r.jsx(L,{name:"generation",values:v==null?void 0:v.map(l=>l.name.split("-")[1]),renderLabel:l=>`Gen. ${l.toUpperCase()}`,isOpen:e,toggleOpen:t}),r.jsx(L,{name:"type",values:w==null?void 0:w.map(l=>l.name),renderLabel:l=>l,isOpen:s,toggleOpen:d}),r.jsxs(h,{onClick:()=>n("onlyStarred","true"),style:a("onlyStarred")?"gold":"normal",className:`mb-4 w-full ${a("onlyStarred")&&"py-[9.5px]"}`,children:["Show",a("onlyStarred")?`ing ${c}`:" only"," starred Pokémon"]}),r.jsx(h,{onClick:()=>void o("/pokedex/pokemon"),disabled:i,style:i?"normal":"indigo",className:"w-full enabled:py-[9.5px] disabled:cursor-not-allowed disabled:opacity-25 lg:mb-4",children:"Clear Filtering"})]})},K=({noOfPages:e,noOfSideButtons:t})=>{const{getUrl:s,setUrl:d}=k(),o=Number(s("page"))||1,a=i=>d("page",i.toString()),n=()=>{const i=[];let c=0;for(let l=o-t;l<=o+t;l++)c--,i.push(l>0&&l<=e?l:c);return i};return r.jsxs("div",{className:"flex gap-2 sm:gap-4",children:[r.jsx(h,{onClick:()=>a(1),disabled:o===1,className:"xs:size-12 flex size-8 items-center justify-center rounded-full disabled:cursor-not-allowed disabled:opacity-25",children:r.jsx(q,{className:"size-4"})}),n().map((i,c)=>i>0?r.jsx(h,{onClick:()=>a(i),disabled:i===o,style:i===o?"indigo":"normal",className:`xs:size-12 ${c===0||c===t*2?"max-sm:hidden":""} flex size-8 items-center justify-center rounded-full disabled:cursor-default`,children:i},i):r.jsx("div",{className:`xs:size-12 ${c===0||c===t*2?"max-sm:hidden":""} size-8`},i)),r.jsx(h,{onClick:()=>a(e),disabled:o===e,className:"xs:size-12 flex size-8 items-center justify-center rounded-full disabled:cursor-not-allowed disabled:opacity-25",children:r.jsx(T,{className:"size-4"})})]})},Q=({type:e})=>{const t=F();return r.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-8 text-center lg:h-screen",children:[r.jsxs("h2",{className:"text-3xl font-bold",children:["No ",e," Found"]}),r.jsx("p",{className:"mb-2 font-semibold text-slate-600 dark:text-slate-400",children:"Try other filtering options or another search query"}),r.jsx(h,{onClick:()=>void t("/pokedex/pokemon"),style:"indigo",className:"w-full max-lg:hidden",children:"Clear Filtering"})]})},H=({id:e,name:t})=>{const{data:s}=A(e),[d,o]=m.useState(!0);return r.jsx(z,{to:`/pokedex/pokemon/${t}`,state:{initialPokemon:s},children:r.jsxs("article",{className:"relative rounded-sm border border-slate-400/40 bg-slate-100 shadow-lg transition-colors hover:bg-slate-200/75 hover:shadow-xl dark:bg-slate-800 dark:shadow-none dark:hover:bg-slate-700/75 dark:hover:shadow-none",children:[r.jsx("img",{src:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/home/${e}.png`,alt:t,onLoad:()=>o(!1),className:"aspect-square w-full object-contain text-transparent dark:brightness-90"}),d?r.jsx("div",{className:"absolute top-0 aspect-square w-full rounded-sm bg-slate-100 dark:bg-slate-800",children:r.jsx(S,{size:8})}):"",r.jsxs("div",{className:"px-3 py-2 md:p-4",children:[r.jsxs("h1",{className:"text-base font-bold text-nowrap capitalize sm:text-lg md:text-xl",children:[e,". ",t]}),r.jsx(D,{types:s==null?void 0:s.types,className:"text-sm font-semibold text-nowrap text-slate-500 md:text-base dark:text-slate-400"})]})]})})},N=({children:e,to:t})=>r.jsx("a",{href:t,target:"_blank",rel:"noreferrer",className:"transition-all hover:border-b hover:text-gray-600 dark:hover:text-gray-300",children:e}),V=()=>r.jsxs("footer",{className:"mt-4 text-center text-sm text-gray-500 transition-colors dark:text-gray-400",children:["Made by"," ",r.jsx(N,{to:"https://github.com/AndreiJoroveanu",children:"Andrei Joroveanu"})," (",r.jsx(N,{to:"https://github.com/AndreiJoroveanu/pokedex",children:"Github repo"}),"). Data from ",r.jsx(N,{to:"https://pokeapi.co",children:"PokéAPI"}),"."]}),$=20,ee=()=>{const{data:e,isLoading:t}=G(),{pokemonList:s,isLoading:d,isFiltered:o}=_(e),a=(s==null?void 0:s.length)??0,n=Math.ceil(a/$),{getUrl:i}=k(),c=Number(i("page"))||1,l=m.useMemo(()=>s==null?void 0:s.slice((c-1)*$,c*$),[c,s]);return r.jsxs("div",{className:"relative pt-18 sm:pt-24",children:[r.jsx(W,{}),r.jsxs("section",{className:"flex w-full flex-col items-center p-4 max-sm:px-2 lg:absolute lg:right-0 lg:w-4/5",children:[!t&&!d?r.jsxs(r.Fragment,{children:[n>1&&r.jsx(K,{noOfPages:n,noOfSideButtons:3}),l!=null&&l.length?r.jsxs(r.Fragment,{children:[r.jsx("main",{className:"mt-4 grid w-full grid-cols-2 gap-2 sm:gap-4 md:grid-cols-4 xl:grid-cols-5",children:l.map(x=>r.jsx(H,{id:x.id,name:x.name},x.name))}),r.jsx(V,{})]}):null]}):r.jsx("div",{className:"fixed top-0 flex h-screen w-full items-center justify-center bg-slate-50 lg:-z-10 dark:bg-slate-900",children:r.jsx(S,{size:24,displaysText:!0})}),!(s!=null&&s.length)&&o&&r.jsx("div",{className:"top-0 lg:fixed lg:h-screen",children:r.jsx(Q,{type:"Pokémon"})})]})]})};export{ee as default};
